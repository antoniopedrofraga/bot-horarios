function apaga_registo(){var e=confirm("Tem a certeza que pretende apagar este registo?");if(e){return true}else{return false}}function showhide(e,t){t=$("#"+t);e=$("#"+e);t.css("display")=t.css("display")=="block"?"none":"block";e.toggleClass("mais menos")}function abre_calendario(e,t,n,r,i){open("web_util.calendario?p_mes="+i+"&p_ano="+r+"&p_data_type="+n+"&p_form_name="+e+"&p_field="+t,"Calendario","scrollbars=no,resizable=no,width=200,height=250")}function toggleAjuda(e,t){if(!$("ifrAjuda").getAttribute($)){$("ifrAjuda").setAttribute("src",t)}$("divAjuda").style.display=$("divAjuda").style.display=="none"?"":"none";$("divAjuda").className="ajuda"+(e?e:"Dir");$("principal").className=$("principal").className=="principal"?"principalPeq"+(e?e:"Dir"):"principal";$("linkFechaAjuda").href="javascript:toggleAjuda('"+e+"');"}function checkAll(e){var t=document.getElementsByName(e);for(var n=0,r=t.length;n<r;n++){if(t[n].checked==false){t[n].checked=true}}}function uncheckAll(e){var t=document.getElementsByName(e);for(var n=0,r=t.length;n<r;n++){if(t[n].checked==true){t[n].checked=false}}}function switchAll(e){var t=document.getElementsByName(e);for(var n=0,r=t.length;n<r;n++){t[n].checked=!t[n].checked}}function ajudaContexto(e,t,n,r){elemento=$(e);if(elemento.getAttribute("id")){if($("ajuda_"+elemento.getAttribute("id").substr(elemento.getAttribute("id").indexOf("_")+1))){var i=$("ajuda_"+elemento.getAttribute("id").substr(elemento.getAttribute("id").indexOf("_")+1));i.parentNode.removeChild(i);elemento.parentNode.className=r;return}}contador++;var s=document.createElement("DIV");if(n){if(n!=0){s.setAttribute("style","float:right;")}}s.setAttribute("id","ajuda_"+contador);s.innerHTML=t;elemento.setAttribute("id","img_"+contador);elemento.parentNode.appendChild(s);elemento.setAttribute("onclick",elemento.getAttribute("onclick").substr(0,elemento.getAttribute("onclick").length-2));elemento.setAttribute("onclick",elemento.getAttribute("onclick")+(n?",'":",null,'")+elemento.parentNode.className+"');");elemento.parentNode.className="ajudaContextual"}function abreCalendario(e,t,n,r,i,s,o){posCal=o;var u=posCal?$n(e,posCal):$(e);if(t){formatoData=t}else{formatoData="DD-MM-YYYY"}var a=u.offsetLeft;var f=u.offsetTop+u.offsetHeight;var l=u;while(l.offsetParent){l=l.offsetParent;a+=l.offsetLeft;f+=l.offsetTop}desenhaCalendario(u,a,f,n,r,i,s)}function desenhaCalendario(e,t,n,r,i,s,o){var u,a,f,l;var c=getDataCampo(e.value);if(r){u=getDataCampo(r)}if(i){a=getDataCampo(i)}if(s){var h=$(s).value;if(h){f=getDataCampo(h);if(!e.value){c=f}}}if(o){var p=$(o).value;if(p){l=getDataCampo(p);if(!e.value){c=l}}}if(u&&f){u=u>f?u:f}else{if(f){u=f}}if(a&&l){a=a<l?a:l}else{if(l){a=l}}if(!$("divCalendario")){var d=document.createElement("div");d.setAttribute("id","divCalendario");d.className="brancob";d.setAttribute("style","visibility: hidden;");document.body.appendChild(d)}var v=$("divCalendario");v.style.position="absolute";v.style.left=t+"px";v.style.top=n+"px";v.style.visibility=v.style.visibility=="visible"?campoAntigo==e?"hidden":"visible":"visible";v.style.display=v.style.display=="block"?campoAntigo==e?"none":"block":"block";v.style.zIndex=1e3;campoAntigo=e;if(!u){u=dataMinAbs}if(!a){a=dataMaxAbs}refreshCalendario(e.name,c.getFullYear(),c.getMonth(),c.getDate(),u.getFullYear(),u.getMonth(),u.getDate(),a.getFullYear(),a.getMonth(),a.getDate())}function conteudoCalendario(e,t,n,r,i,s,o){posCal=o;var u=posCal?$n(e,posCal):$(e);if(t){formatoData=t}else{formatoData="DD-MM-YYYY"}var a,f,l,c;var h=getDataCampo(u.value);if(n){a=getDataCampo(n)}if(r){f=getDataCampo(r)}if(i){var p=$(i).value;if(p){l=getDataCampo(p);if(!u.value){h=l}}}if(s){var d=$(s).value;if(d){c=getDataCampo(d);if(!u.value){h=c}}}if(a&&l){a=a>l?a:l}else{if(l){a=l}}if(f&&c){f=f<c?f:c}else{if(c){f=c}}campoAntigo=u;if(!a){a=dataMinAbs}if(!f){f=dataMaxAbs}return refreshCalendario(u.name,h.getFullYear(),h.getMonth(),h.getDate(),a.getFullYear(),a.getMonth(),a.getDate(),f.getFullYear(),f.getMonth(),f.getDate(),1)}function refreshCalendario(e,t,n,r,i,s,o,u,a,f,l){var c,h;if(i&&o&&(s||s==0)){c=new Date(i,s,o)}if(u&&f&&(a||a==0)){h=new Date(u,a,f)}var p=new Date;if(n>=0&&t>0){p=new Date(t,n,1)}else{r=p.getDate();p.setDate(1)}var d=p.getFullYear();if(p.lastDay()<c){refreshCalendario(e,i,s,r,i,s,o,u,a,f);return}if(p>h){refreshCalendario(e,u,a,r,i,s,o,u,a,f);return}var v="<table class='tabela'>";v+="<tr>";if(!c||d>c.getFullYear()){v+="<td class='brancod'>"+botoesAntSeg(e,p,-12,"&lt;",i,s,o,u,a,f)+"</td>"}else{v+="<td class='brancod'></td>"}v+="<td colspan=5 class='brancoc'><div>";v+="<select id='p_ano' name='p_ano' onchange=\"refreshCalendario('"+e+"',this.value,"+n+","+r+","+i+","+s+","+o+","+u+","+a+","+f+')">';var m=d-100>i?d-100:i;for(var g=m;g<d;g++){v+="<option value='"+g+"'>"+g+"</option>"}v+="<option value='"+d+"' selected='selected'>"+d+"</option>";var y=d+30<u?d+30:u;for(g=d+1;g<=y;g++){v+="<option value='"+g+"'>"+g+"</option>"}v+="</select></div></td>";if(!h||d<h.getFullYear()){v+="<td class='branco'>"+botoesAntSeg(e,p,12,"&gt;",i,s,o,u,a,f)+"</td>"}else{v+="<td class='brancod'></td>"}v+="</tr>";v+="<tr>";if(p<=c){v+="<td class='brancod'></td>"}else{v+="<td class='brancod'>"+botoesAntSeg(e,p,-1,"&lt;",i,s,o,u,a,f)+"</td>"}v+="<td colspan=5 class='brancoc'><div>";v+="<select id='p_mes' name='p_mes' onchange=\"refreshCalendario('"+e+"',"+d+",this.value,"+r+","+i+","+s+","+o+","+u+","+a+","+f+')">';for(g=0;g<12;g++){if(!(d==c.getFullYear()&&g<s||d==h.getFullYear()&&g>a)){if(g==p.getMonth()){v+="<option value='"+g+"' selected='selected'>"+mesesArrayGr[g]+"</option>"}else{v+="<option value='"+g+"'>"+mesesArrayGr[g]+"</option>"}}}v+="</select></div></td>";if(p.lastDay()>=h){v+="<td class='brancod'></td>"}else{v+="<td class='branco'>"+botoesAntSeg(e,p,1,"&gt;",i,s,o,u,a,f)+"</td>"}v+="</tr>";v+="<tr>";for(g=0;g<diasArrayPeq.length;g++){v+="<th>"+diasArrayPeq[g]+"</th>"}v+="</tr>";v+="<tr>";for(g=0;g<p.getDay();g++){v+="<td class='escuro'></td>"}do{numDia=p.getDate();if(numDia==r){v+="<td class='calendsel' style='cursor:pointer; cursor:hand;' onMouseOut='this.className=\"calendsel\";' onMouseOver='this.className=\"calendeventsel\";' onclick=\"preencheCampoForm('"+e+"', '"+getDateString(p)+"');\"><div>"+numDia+"</div></td>"}else{if(p<c||p>h){v+="<td class='escuroc'><span class='cinzento'>"+numDia+"</span></td>"}else{v+="<td class='claroc' style='cursor:pointer; cursor:hand;' onMouseOut='this.className=\"claroc\";' onMouseOver='this.className=\"calendevent\";'  onclick=\"preencheCampoForm('"+e+"', '"+getDateString(p)+"');\">"+numDia+"</td>"}}if(p.getDay()==6){v+="</tr><tr>"}p.setDate(p.getDate()+1)}while(p.getDate()>1);if(p.getDay()>0){for(g=7;g>p.getDay();g--){v+="<td class='escuro'></td>"}}v+="</tr></table>";v+="<p class='formulariobotoes'>";v+="<button onClick='refreshCalendario(\""+e+'",null,null,null,'+i+","+s+","+o+","+u+","+a+","+f+");'><img src='imagens/BotaoHoje' alt=''  title=''   class='border0'> <span class='textopequeno'>Hoje</span></button> ";v+="<button onClick='preencheCampoForm(\""+e+"\");'><img src='imagens/BotaoApagar' alt=''  title=''   class='border0'> <span class='textopequeno'>Fechar</span></button>";v+="</p>";if(l){return v}else{$("divCalendario").innerHTML=v}}function botoesAntSeg(e,t,n,r,i,s,o,u,a,f){var l=(t.getMonth()+n)%12;var c=t.getFullYear()+parseInt((t.getMonth()+n)/12);if(l<0){l+=12;c+=-1}return"<img src='/gessi/imagens/"+(n<0?"Seta_Esquerda":"Seta_Direita")+"' style='cursor: pointer; cursor: hand;' alt='Seta Esquerda' title='' class='border0' width='11' height='11' onClick='refreshCalendario(\""+e+'",'+c+","+l+",null,"+i+","+s+","+o+","+u+","+a+","+f+");' >"}function getDateString(e){var t=formatoData;var n="00"+e.getDate();var r="00"+(e.getMonth()+1);n=n.substring(n.length-2);r=r.substring(r.length-2);t=t.toLowerCase().replace("dd",n);t=t.toLowerCase().replace("mm",r);t=t.toLowerCase().replace("yyyy",e.getFullYear());t=t.toLowerCase().replace("rrrr",e.getFullYear());return t}function getDataCampo(e){var t;var n;var r,i,s;try{n=separaData(e);if(n){if(formatoData.toLowerCase().match("d.*m.*[yr].*")){r=parseInt(n[0]);i=parseInt(n[1])-1;s=parseInt(n[2])}else{if(formatoData.toLowerCase().match("m.*d.*[yr].*")){r=parseInt(n[1]);i=parseInt(n[0])-1;s=parseInt(n[2])}else{if(formatoData.toLowerCase().match("[yr].*m.*d.*")){r=parseInt(n[2]);i=parseInt(n[1])-1;s=parseInt(n[0])}else{r=parseInt(n[0]);i=parseInt(n[1])-1;s=parseInt(n[2])}}}t=new Date(s,i,r)}else{if(e){t=new Date(e)}else{t=new Date}}}catch(o){t=new Date}return t}function separaData(e){var t;if(e.indexOf("/")>=0){t=e.split("/")}else{if(e.indexOf(".")>=0){t=e.split(".")}else{if(e.indexOf("-")>=0){t=e.split("-")}else{if(e.indexOf("\\")>=0){t=e.split("\\")}else{t=false}}}}return t}function preencheCampoForm(e,t){var n=posCal?$n(e,posCal):$(e);if(t){n.value=t}var r=$("divCalendario");r.style.visibility="hidden";r.style.display="none";n.focus()}function $(){var e=new Array;for(var t=0;t<arguments.length;t++){var n=arguments[t];if(typeof n=="string"){if(document.getElementById(n)){n=document.getElementById(n)}else{n=document.getElementsByName(n)[0]}}if(arguments.length==1){return n}e.push(n)}return e}function $n(e,t){return document.getElementsByName(e)[t-1]}function showhide(e,t){if(document.getElementById){document.getElementById(t).style.display=document.getElementById(t).style.display=="none"?"":"none";document.getElementById(e).className=document.getElementById(e).className=="mais"?"menos":"mais"}else{if(document.layers){document.layers[t].style.visibility=document.layers[t].style.visibility=="hide"?"show":"hide";e.className=e.className=="mais"?"menos":"mais"}else{if(document.all){document.all(t).style.visibility=document.all(t).style.visibility=="hidden"?"visible":"hidden";e.className=e.className=="mais"?"menos":"mais"}}}}function inicializaXmlReq(){try{return new XMLHttpRequest}catch(e){try{return ActiveXObject("Msxml2.XMLHTTP")}catch(t){try{return new ActiveXObject("Microsoft.XMLHTTP")}catch(n){return false}}}}function enviaPedidoAjax(e,t,n){if(xmlReq){xmlReq.abort()}xmlReq=inicializaXmlReq(xmlReq);xmlReq.open("POST",e,true);xmlReq.setRequestHeader("Content-Type","application/x-www-form-urlencoded");xmlReq.send(t);xmlReq.onreadystatechange=n}function abreFloatDiv(e,t,n,r){try{clearTimeout(timerID)}catch(i){}try{clearTimeout(timerIDHide)}catch(i){}if(xmlReq){xmlReq.abort()}var s=document.getElementsByName(e).item(0);var o=s.offsetLeft;var u=s.offsetTop+s.offsetHeight;var a=s;while(a.offsetParent){a=a.offsetParent;o+=a.offsetLeft;u+=a.offsetTop}desenhaFloatDiv(s,o,u,t,n)}function desenhaFloatDiv(campoDestino,posX,posY,funcao,classe,altura){var dt=campoDestino.value;if(!document.getElementById(floatDiv)){var novoNo=document.createElement("div");novoNo.setAttribute("id",floatDiv);novoNo.className="brancob";novoNo.setAttribute("style","visibility: hidden;");document.body.appendChild(novoNo)}var pickerDiv=document.getElementById(floatDiv);pickerDiv.style.position="absolute";pickerDiv.style.left=posX+"px";pickerDiv.style.top=posY+"px";pickerDiv.className=classe;pickerDiv.style.visibility=pickerDiv.style.visibility=="visible"?campoAntigo==campoDestino?"hidden":"visible":"visible";pickerDiv.style.display=pickerDiv.style.display=="block"?campoAntigo==campoDestino?"none":"block":"block";pickerDiv.style.zIndex=1e3;campoAntigo=campoDestino;if(funcao){html=eval(funcao);document.getElementById(floatDiv).innerHTML=html}}function hideDiv(){var e=document.getElementById(floatDiv);if(e){e.style.visibility="hidden";e.style.display="none";campoAntigo="";e.innerHTML=""}}function hideDivT(e){timerIDHide=setTimeout("hideDiv();",e)}function refreshFloatDiv(){var e="<p>";e+="</p>";return e}function enviaPedidoDiv(e,t,n){enviaPedidoAjax(e,t,n)}function getConteudoDivSug(e,t,n,r,i,s,o,u,a){var f=e.keyCode;nomeTagSel=i;verificaDivAberta(o,u,a);if(f==40||f==38){activaLinha(indiceSelect+(f==40?1:elementosDiv.length-1));indiceSelect+=f==40?1:elementosDiv.length-1;return true}if(f==13||f==9){return true}document.getElementById(s).value="";indiceSelect=-1;if(timerID){clearTimeout(timerID)}if(r){if(t>0){timerID=setTimeout('enviaPedidoDiv("'+n+'", "", actualizaDiv);',t)}else{enviaPedidoDiv(n,"",actualizaDiv)}}}function trataSeleccaoTeclado(e){var t=e.keyCode;if(t==13||t==9){if(indiceSelect!=-1){elementosDiv[Math.abs(indiceSelect%elementosDiv.length)].onclick()}else{if(elementosDiv.length==1){elementosDiv[0].onclick()}}}}function activaLinha(e){try{var t;try{t=elementosDiv[Math.abs(indiceSelect%elementosDiv.length)].classNameOld}catch(n){}elementosDiv[Math.abs(indiceSelect%elementosDiv.length)].className=t}catch(n){}elementosDiv[Math.abs(e%elementosDiv.length)].classNameOld=elementosDiv[Math.abs(e%elementosDiv.length)].className;elementosDiv[Math.abs(e%elementosDiv.length)].className="lovlistaitemselec";return false}function detectaRatoLista(e){var t=this.posicao?this.posicao:e.srcElement?e.srcElement.posicao:e.target?e.target.posicao:"";activaLinha(t-1);indiceSelect=t-1}function actualizaDiv(){if(xmlReq.readyState==4){try{if(xmlReq.status==200){var e=xmlReq.responseText.replace("\n","");if(e==""){document.getElementById(floatDiv).innerHTML="N&atilde;o existem moradas correspondentes aos valores introduzidos."}else{document.getElementById(floatDiv).innerHTML=e;elementosDiv=document.getElementById(floatDiv).getElementsByTagName(nomeTagSel);for(var t=0;t<elementosDiv.length;t++){if(elementosDiv[t].addEventListener){elementosDiv[t].addEventListener("mouseover",detectaRatoLista,false)}if(elementosDiv[t].attachEvent){elementosDiv[t].attachEvent("onmouseover",detectaRatoLista)}elementosDiv[t].posicao=t+1}}}}catch(n){xmlReq.abort();xmlReq=inicializaXmlReq(xmlReq)}}}function verificaDivAberta(e,t,n){var r=document.getElementById(floatDiv);try{if(r.style.visibility!="visible"||r.style.display!="block"){abreFloatDiv(e,"",t,n)}}catch(i){abreFloatDiv(e,"",t,n)}}function AddToFavorites(){var e=document.title;var t=location.href;if(window.sidebar){window.sidebar.addPanel(e,t,"")}else{if(window.opera&&window.print){var n=document.createElement("a");n.setAttribute("href",t);n.setAttribute("title",e);n.setAttribute("rel","sidebar");n.click()}else{if(document.all){window.external.AddFavorite(t,e)}}}}function getAjudaContexto(e,t){elemento=$(e);contadorAjuda++;divAjuda=$('<div class="ajudaContextual">'+imgHtmlLoadAjuda+"</div>");divAjuda.attr("id","ajuda_"+contadorAjuda);elemento.prev().prev().before(divAjuda);elemento.setAttribute("onclick","ajudaContextoToggle("+contadorAjuda+")");divAjuda.ajaxError(function(e,n,r,i){$("div#ajuda_"+contadorAjuda).next().next().attr("onclick","getAjudaContexto(this,'"+t+"')");$("div#ajuda_"+contadorAjuda).remove()});divAjuda.load(t)}function ajudaContextoToggle(e){$("div#ajuda_"+e).toggle()}function add_atalho(e,t,n,r){var i=document.getElementById("caixa-atalhos-conteudo-ul");var s=document.createElement("li");s.setAttribute("id","caixa-atalhos-conteudo-adicionar");s.innerHTML='<a href="#" onclick="AdicionaAtalho=window.open(\'atalhos.pre_adiciona?P_id='+e+"&P_para="+t+"&P_nome='+escape('"+n+"') , 'AdicionaAtalho', 'width=400,height=200,scrollbars=yes,statusbar=no,resizable=yes,top=0,left=0,dependent=yes');AdicionaAtalho.focus();return true;\" class=\"opcaoatalho\">"+r+"</a>";i.appendChild(s)}var contador=1;var floatDiv="floatDiv";var timerID;var campoAntigo;var elementosDiv;var indiceSelect=-1;var nomeTagSel;var diasArrayPeq=new Array("D","S","T","Q","Q","S","S");var diasArrayGr=new Array("Domingo","Segunda","Ter&ccedeil;a","Quarta","Quinta","Sexta","S&acute;bado");var mesesArrayPeq=new Array("Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez");var mesesArrayGr=new Array("Janeiro","Fevereiro","Mar&ccedil;o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro");var formatoData="DD-MM-YYYY";var formatoData,campoAntigo,posCal;var dataMinAbs=new Date(1e3,1,1);var dataMaxAbs=new Date(3e3,11,31);Date.prototype.lastDay=function(){var e=new Date(this.getTime());e.setMonth(e.getMonth()+1);e.setDate(0);return e};var xmlReq=inicializaXmlReq();contadorAjuda=0;imgHtmlLoadAjuda='<img src="imagens/loading_ajax" alt="A Carregar..." title="A Carregar..." class="border0">';